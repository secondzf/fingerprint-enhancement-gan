# 指纹图像增强 GAN 项目

这是一个**本科课程设计**项目，使用 PyTorch 实现基于 GAN 的指纹图像增强系统。  
项目主要针对指纹图像在采集过程中出现的模糊、噪声、断裂等问题，通过渐进式训练的 GAN 模型进行修复和增强。

**声明**：  
这是本人大四的课程设计，代码和思路都比较基础。模型结构、训练策略、损失函数组合等都属于学习和尝试阶段，水平有限，存在很多可以优化的地方。欢迎老师和同学批评指正，仅供学习交流使用。

## 项目目标
- 通过合成退化数据进行三阶段渐进式预训练
- 使用真实潜指纹（latent fingerprint）进行后训练（aftrain）
- 最终实现对低质量指纹图像的增强，提升脊线清晰度、连续性和对比度

## 项目核心思路

1. **渐进式预训练（Stage 1~3）**  
   从轻度模糊逐步过渡到中度模糊和复杂退化（包含运动模糊、亮度/对比变化、随机擦除等），让生成器逐步学会修复越来越难的退化。  
   使用合成数据（清晰指纹 + 人工退化）进行监督训练。

2. **真实 latent 后训练（aftrain 阶段）**  
   以真实采集的潜指纹作为输入，对应的清晰指纹作为目标，进行 fine-tune，进一步适应真实场景。

3. **模型结构**  
   - 生成器：基于 UNet + CBAM（通道 + 空间注意力）  
   - 判别器：PatchGAN（输出局部真实性 patch map）  
   - 损失：L1 + 感知损失（VGG） + SSIM + 方向场损失（脊线方向约束） + 对抗损失

4. **预处理**  
   结合传统图像处理、Gabor 滤波和局部质量图引导的纹理增强，用于准备后训练阶段的输入。

## 文件模块简要说明

- `config.py`：全局配置（路径、超参数、阶段设置等）  
- `generator.py`：UNet 生成器（带注意力机制）  
- `discriminator.py`：Patch 判别器  
- `dataset.py`：数据集加载 + 动态退化模拟（预训练） / 真实配对加载（后训练）  
- `losses.py`：L1、SSIM、感知、方向场、对抗等损失函数  
- `train.py` / `train_stage.py`：多阶段训练主逻辑  
- `pre.py`：传统预处理 + Gabor 增强（生成 aftrain 输入）  
- `enhance.py`：最终推理脚本（加载模型增强图像）  
- `metrics.py` / `checkpoint.py`：样本保存、模型保存/加载辅助功能

## 关于数据集和模型

本项目使用的训练/验证数据集由课程指导老师提供，仅限课程学习和实验使用。  
为遵守数据使用规范，本仓库**仅包含模型代码、训练脚本和配置文件**，**不包含任何原始/预处理数据、图像样本或训练得到的模型权重文件**。  
所有数据路径均为示例，实际运行时请根据本地环境自行修改，并在老师指导下使用课程提供的相同数据集进行实验。

感谢老师提供的宝贵数据资源和课程指导，本项目仅用于学习和课程展示。

最后更新：2026 年 2 月  
